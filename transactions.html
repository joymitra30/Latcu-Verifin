<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Transactions - ThinkShip ERP</title>
  <style>
    :root{--bg:#f6f8fb;--card:#fff;--muted:#6b7280;--brand:#6366f1}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:var(--bg);color:#0f172a;margin:0;padding:20px}
    .container{max-width:1200px;margin:0 auto}
    header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
    h1{font-size:20px;margin:0}
    .muted{color:var(--muted)}
    .tabs{display:flex;gap:8px;margin-top:12px}
    .tab{padding:8px 12px;border-radius:8px;background:#fff;border:1px solid rgba(15,23,42,0.04);cursor:pointer}
    .tab.active{background:linear-gradient(90deg,#eef2ff,#fff);border-color:rgba(99,102,241,0.18);color:var(--brand);font-weight:700}
    .card{background:var(--card);border-radius:12px;padding:16px;box-shadow:0 6px 24px rgba(15,23,42,0.06);margin-top:12px}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    input[type=text], input[type=date], input[type=number], select, textarea{width:100%;padding:10px;border:1px solid #e6edf3;border-radius:8px;font-size:14px}
    textarea{min-height:80px}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .actions{display:flex;gap:8px;justify-content:flex-end;margin-top:12px}
    button{background:var(--brand);color:#fff;padding:10px 12px;border-radius:8px;border:0;cursor:pointer}
    button.ghost{background:transparent;color:var(--brand);border:1px solid rgba(99,102,241,0.12)}
    table{width:100%;border-collapse:collapse;margin-top:12px}
    th,td{padding:8px;text-align:left;border-bottom:1px solid #f1f5f9;font-size:13px}
    th{color:var(--muted);background:#fbfdff}
    .right{text-align:right}
    .small{font-size:13px;padding:6px 8px;border-radius:8px}
    .pill{display:inline-block;padding:4px 8px;border-radius:999px;background:#f1f5f9;color:#0f172a;font-weight:600;font-size:12px}
    .status.pending{background:#fffbeb;color:#92400e}
    .status.approved{background:#ecfdf5;color:#065f46}
    .status.rejected{background:#fff1f2;color:#9f1239}
    @media(max-width:900px){.grid2{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>Transactions</h1>
        <div class="muted">Manage Expense, Income, Internal Transfers and other transactions. Approved expenses auto-post to General Ledger.</div>
      </div>
      <div>
        <button class="ghost small" onclick="exportAll()">Export All CSV</button>
      </div>
    </header>

    <div class="tabs" role="tablist">
      <div class="tab active" data-tab="expense" onclick="showTab('expense')">Expense Management</div>
      <div class="tab" data-tab="income" onclick="showTab('income')">Income Management</div>
      <div class="tab" data-tab="transfer" onclick="showTab('transfer')">Internal Cash Transfer</div>
      <div class="tab" data-tab="other" onclick="showTab('other')">Other Transactions</div>
    </div>

    <!-- Expense -->
    <section id="expense" class="card">
      <h3>Create Expense Request</h3>
      <form id="expenseForm" onsubmit="return saveExpense(event)">
        <div class="grid2">
          <div>
            <label for="expDate">Date</label>
            <input id="expDate" type="date" required />
          </div>
          <div>
            <label for="expAmount">Amount</label>
            <input id="expAmount" type="number" step="0.01" required />
          </div>
        </div>

        <div style="margin-top:12px">
          <label for="expCategory">Category</label>
          <select id="expCategory">
            <option value="Travel">Travel</option>
            <option value="Supplies">Supplies</option>
            <option value="Meals">Meals</option>
            <option value="Other">Other</option>
          </select>
        </div>

        <div style="margin-top:12px" class="grid2">
          <div>
            <label for="expDept">Department / Cost Center</label>
            <input id="expDept" type="text" placeholder="e.g. Sales" />
          </div>
          <div>
            <label for="expLinkedAccount">Linked Account</label>
            <select id="expLinkedAccount"></select>
          </div>
        </div>

        <div style="margin-top:12px">
          <label for="expDesc">Description</label>
          <textarea id="expDesc"></textarea>
        </div>

        <div class="actions">
          <button type="button" class="ghost" onclick="resetExpenseForm()">Reset</button>
          <button type="submit">Submit Expense</button>
        </div>
      </form>

      <div style="margin-top:18px">
        <h4>Expense Requests</h4>
        <div style="display:flex;gap:8px;margin-bottom:8px">
          <select id="expenseFilterStatus" onchange="renderExpenses()"><option value="all">All</option><option value="pending">Pending</option><option value="approved">Approved</option><option value="rejected">Rejected</option></select>
          <input id="expenseSearch" type="text" placeholder="search description or dept" oninput="renderExpenses()" style="padding:8px;border-radius:8px;border:1px solid #eef2f7" />
        </div>
        <table id="expensesTable"><thead><tr><th>Date</th><th>Description</th><th>Dept</th><th>Category</th><th class="right">Amount</th><th>Status</th><th></th></tr></thead><tbody></tbody></table>
      </div>
    </section>

    <!-- Income -->
    <section id="income" class="card" style="display:none">
      <h3>Record Income</h3>
      <form id="incomeForm" onsubmit="return saveIncome(event)">
        <div class="grid2">
          <div>
            <label for="incDate">Date</label>
            <input id="incDate" type="date" required />
          </div>
          <div>
            <label for="incAmount">Amount</label>
            <input id="incAmount" type="number" step="0.01" required />
          </div>
        </div>

        <div style="margin-top:12px">
          <label for="incCustomer">Customer / Source</label>
          <input id="incCustomer" type="text" placeholder="Customer name" />
        </div>

        <div style="margin-top:12px" class="grid2">
          <div>
            <label for="incLinkedAccount">Linked Income Account</label>
            <select id="incLinkedAccount"></select>
          </div>
          <div>
            <label for="incReceivedTo">Received To (Cash/Bank)</label>
            <select id="incReceivedTo"></select>
          </div>
        </div>

        <div style="margin-top:12px">
          <label for="incDesc">Description</label>
          <textarea id="incDesc"></textarea>
        </div>

        <div class="actions">
          <button type="button" class="ghost" onclick="resetIncomeForm()">Reset</button>
          <button type="submit">Record Income</button>
        </div>
      </form>

      <div style="margin-top:18px">
        <h4>Income Records</h4>
        <table id="incomeTable"><thead><tr><th>Date</th><th>Source</th><th>Description</th><th class="right">Amount</th><th></th></tr></thead><tbody></tbody></table>
      </div>
    </section>

    <!-- Transfer -->
    <section id="transfer" class="card" style="display:none">
      <h3>Internal Cash Transfer</h3>
      <form id="transferForm" onsubmit="return saveTransfer(event)">
        <div class="grid2">
          <div>
            <label for="trDate">Date</label>
            <input id="trDate" type="date" required />
          </div>
          <div>
            <label for="trAmount">Amount</label>
            <input id="trAmount" type="number" step="0.01" required />
          </div>
        </div>

        <div style="margin-top:12px" class="grid2">
          <div>
            <label for="trFrom">From (Account)</label>
            <select id="trFrom"></select>
          </div>
          <div>
            <label for="trTo">To (Account)</label>
            <select id="trTo"></select>
          </div>
        </div>

        <div style="margin-top:12px">
          <label for="trDesc">Description</label>
          <textarea id="trDesc"></textarea>
        </div>

        <div class="actions">
          <button type="button" class="ghost" onclick="resetTransferForm()">Reset</button>
          <button type="submit">Post Transfer</button>
        </div>
      </form>

      <div style="margin-top:18px">
        <h4>Transfers</h4>
        <table id="transferTable"><thead><tr><th>Date</th><th>From</th><th>To</th><th class="right">Amount</th><th></th></tr></thead><tbody></tbody></table>
      </div>
    </section>

    <!-- Other Transactions -->
    <section id="other" class="card" style="display:none">
      <h3>Other Transactions (Custom Journal)</h3>
      <form id="otherForm" onsubmit="return saveOther(event)">
        <div class="grid2">
          <div>
            <label for="otDate">Date</label>
            <input id="otDate" type="date" required />
          </div>
          <div>
            <label for="otRef">Reference</label>
            <input id="otRef" type="text" />
          </div>
        </div>

        <div style="margin-top:12px">
          <label>Journal Lines</label>
          <div style="display:flex;gap:8px;margin-top:8px">
            <select id="otAccount"></select>
            <select id="otDC"><option value="debit">Dr</option><option value="credit">Cr</option></select>
            <input id="otAmount" type="number" step="0.01" placeholder="Amount" />
            <input id="otDesc" type="text" placeholder="Narration" />
            <button type="button" class="ghost small" onclick="addOtherLine()">Add</button>
          </div>
          <table id="otherLinesTable"><thead><tr><th>Account</th><th>Desc</th><th class="right">Debit</th><th class="right">Credit</th><th></th></tr></thead><tbody></tbody><tfoot><tr><th>Total</th><th></th><th class="right" id="otherDebitTotal">0</th><th class="right" id="otherCreditTotal">0</th><th></th></tr></tfoot></table>
        </div>

        <div class="actions">
          <button type="button" class="ghost" onclick="resetOtherForm()">Reset</button>
          <button type="submit">Post Journal</button>
        </div>
      </form>
    </section>

  </div>

  <script>
    // LocalStorage keys
    const EXP_KEY = 'ts_demo_expenses_v1';
    const INC_KEY = 'ts_demo_income_v1';
    const TR_KEY = 'ts_demo_transfers_v1';
    const OT_KEY = 'ts_demo_other_v1';
    const GL_KEY = 'ts_demo_gl_v1';
    const COA_KEY = 'coa_demo_accounts_v1';

    let expenses = []; let incomes = []; let transfers = []; let otherJournals = []; let coa = []; let journal = [];

    function showTab(tab){ document.querySelectorAll('section.card').forEach(s=> s.style.display='none'); document.getElementById(tab).style.display='block'; document.querySelectorAll('.tab').forEach(t=> t.classList.toggle('active', t.getAttribute('data-tab')===tab)); }

    // load COA and journal
    function loadCOA(){ try{ coa = JSON.parse(localStorage.getItem(COA_KEY)||'[]') }catch(e){ coa=[] }
      // populate selects
      const accSelects = ['expLinkedAccount','expLinkedAccount','incLinkedAccount','incReceivedTo','trFrom','trTo','otAccount','expLinkedAccount'];
      const unique = Array.from(new Set(accSelects));
      unique.forEach(id=>{ const el = document.getElementById(id); if(!el) return; el.innerHTML = '<option value="">-- Select account --</option>'; coa.forEach(a=>{ const o = document.createElement('option'); o.value = a.code||a.id; o.textContent = (a.code? a.code+' — ':'')+a.name; el.appendChild(o) }) });
      // also fill expLinkedAccount final
      const expLA = document.getElementById('expLinkedAccount'); if(expLA) expLA.innerHTML = '<option value="">-- Select account --</option>'; coa.forEach(a=>{ const o=document.createElement('option'); o.value=a.code||a.id; o.textContent=(a.code? a.code+' — ':'')+a.name; if(expLA) expLA.appendChild(o) });
    }

    function loadAll(){ try{ expenses = JSON.parse(localStorage.getItem(EXP_KEY)||'[]') }catch(e){ expenses=[] }
      try{ incomes = JSON.parse(localStorage.getItem(INC_KEY)||'[]') }catch(e){ incomes=[] }
      try{ transfers = JSON.parse(localStorage.getItem(TR_KEY)||'[]') }catch(e){ transfers=[] }
      try{ otherJournals = JSON.parse(localStorage.getItem(OT_KEY)||'[]') }catch(e){ otherJournals=[] }
      try{ journal = JSON.parse(localStorage.getItem(GL_KEY)||'[]') }catch(e){ journal=[] }
      renderExpenses(); renderIncomes(); renderTransfers(); renderOtherLines(); }

    // ---------- Expenses ----------
    function saveExpense(e){ if(e) e.preventDefault(); const date = document.getElementById('expDate').value; const amount = parseFloat(document.getElementById('expAmount').value||0); const category = document.getElementById('expCategory').value; const dept = document.getElementById('expDept').value; const linked = document.getElementById('expLinkedAccount').value; const desc = document.getElementById('expDesc').value.trim(); if(!date || !amount || !linked){ alert('Please fill date, amount and linked account'); return false }
      const obj = { id: 'e'+Math.random().toString(36).slice(2,9), date, amount, category, dept, linkedAccount:linked, description:desc, status:'pending', createdAt: new Date().toISOString() };
      expenses.push(obj); localStorage.setItem(EXP_KEY, JSON.stringify(expenses)); renderExpenses(); resetExpenseForm(); alert('Expense submitted (pending approval)'); return false; }

    function renderExpenses(){ const tbody = document.querySelector('#expensesTable tbody'); tbody.innerHTML=''; const statusFilter = document.getElementById('expenseFilterStatus').value; const q = (document.getElementById('expenseSearch').value||'').toLowerCase(); expenses.slice().reverse().forEach(exp=>{ if(statusFilter!=='all' && exp.status!==statusFilter) return; if(q && !(exp.description||'').toLowerCase().includes(q) && !(exp.dept||'').toLowerCase().includes(q)) return; const acct = coa.find(a=> (a.code||a.id) === exp.linkedAccount); const accLabel = acct ? ((acct.code?acct.code+' — ':'')+acct.name) : exp.linkedAccount; const tr = document.createElement('tr'); tr.innerHTML = `<td>${exp.date}</td><td>${escapeHtml(exp.description||'')}</td><td>${escapeHtml(exp.dept||'')}</td><td>${escapeHtml(exp.category||'')}</td><td class="right">${Number(exp.amount).toLocaleString()}</td><td><span class="pill status ${exp.status}">${exp.status}</span></td><td style="text-align:right">${exp.status==='pending'? '<button class="small" onclick="approveExpense(\'${exp.id}\')">Approve</button><button class="small ghost" onclick="rejectExpense(\'${exp.id}\')">Reject</button>' : (exp.status==='approved' ? '<button class="small ghost" onclick="viewExpenseJournal(\''+exp.id+'\')">View Journal</button>' : '')}</td>`; tbody.appendChild(tr); }); }

    function resetExpenseForm(){ document.getElementById('expenseForm').reset(); }

    function approveExpense(id){ if(!confirm('Approve this expense and post to General Ledger?')) return; const exp = expenses.find(x=>x.id===id); if(!exp) return; exp.status='approved'; exp.approvedAt = new Date().toISOString(); // post to GL: Debit expense account, Credit cash/bank (choose linked account as expense and pick a cash account)
      const expenseAcc = coa.find(a=> (a.code||a.id)===exp.linkedAccount) || coa.find(a=> (a.type||'').toLowerCase()==='expense'); const cashAcc = coa.find(a=> (a.name||'').toLowerCase().includes('cash') || (a.code||'').startsWith('11')) || coa[0]; if(!expenseAcc || !cashAcc){ alert('COA missing expense or cash account. Please configure Chart of Accounts.'); } else {
        const lines = [ {account: expenseAcc.code||expenseAcc.id, desc: 'Expense: '+(exp.description||''), dc:'debit', amount: exp.amount}, {account: cashAcc.code||cashAcc.id, desc: 'Paid from cash/bank', dc:'credit', amount: exp.amount} ]; const entry = { id: 'j'+Math.random().toString(36).slice(2,9), date: exp.date, ref: 'EXP-'+exp.id, description: 'Expense approval '+exp.id, lines, totalDebit: exp.amount, totalCredit: exp.amount };
        journal.push(entry); localStorage.setItem(GL_KEY, JSON.stringify(journal)); exp.journalId = entry.id; }
      localStorage.setItem(EXP_KEY, JSON.stringify(expenses)); renderExpenses(); loadAll(); alert('Expense approved and posted to GL'); }

    function rejectExpense(id){ if(!confirm('Reject this expense?')) return; const exp = expenses.find(x=>x.id===id); if(!exp) return; exp.status='rejected'; exp.rejectedAt = new Date().toISOString(); localStorage.setItem(EXP_KEY, JSON.stringify(expenses)); renderExpenses(); alert('Expense rejected'); }

    function viewExpenseJournal(expId){ const exp = expenses.find(x=>x.id===expId); if(!exp || !exp.journalId){ alert('No journal found for this expense'); return } const j = journal.find(x=>x.id===exp.journalId); if(!j){ alert('Journal entry missing'); return } alert('Journal '+j.id+' posted on '+j.date+'\nLines:\n'+ j.lines.map(l=> (l.account+' '+l.dc+' '+l.amount)).join('\n')); }

    // ---------- Income ----------
    function saveIncome(e){ if(e) e.preventDefault(); const date = document.getElementById('incDate').value; const amount = parseFloat(document.getElementById('incAmount').value||0); const source = document.getElementById('incCustomer').value; const incAcct = document.getElementById('incLinkedAccount').value; const receivedTo = document.getElementById('incReceivedTo').value; const desc = document.getElementById('incDesc').value; if(!date||!amount||!incAcct||!receivedTo){ alert('Please fill date, amount, income account and received-to account'); return false }
      const entry = { id:'j'+Math.random().toString(36).slice(2,9), date, ref: 'INC-'+Math.floor(Math.random()*9000+1000), description: 'Income: '+(desc||source||''), lines:[ {account: receivedTo, dc:'debit', amount}, {account: incAcct, dc:'credit', amount} ], totalDebit: amount, totalCredit: amount };
      journal.push(entry); localStorage.setItem(GL_KEY, JSON.stringify(journal)); incomes.push({ id:'i'+Math.random().toString(36).slice(2,9), date, amount, source, description: desc, journalId: entry.id }); localStorage.setItem(INC_KEY, JSON.stringify(incomes)); renderIncomes(); loadAll(); alert('Income recorded and posted to GL'); return false; }

    function renderIncomes(){ const tbody = document.querySelector('#incomeTable tbody'); tbody.innerHTML=''; incomes.slice().reverse().forEach(inc=>{ const tr = document.createElement('tr'); tr.innerHTML = `<td>${inc.date}</td><td>${escapeHtml(inc.source||'')}</td><td>${escapeHtml(inc.description||'')}</td><td class="right">${Number(inc.amount).toLocaleString()}</td><td style="text-align:right"><button class="small ghost" onclick="viewJournal('${inc.journalId}')">View</button></td>`; tbody.appendChild(tr); }); }

    function viewJournal(jid){ const j = journal.find(x=>x.id===jid); if(!j){ alert('Journal not found'); return } alert('Journal '+j.id+'\n'+ j.lines.map(l=> (l.account+' '+l.dc+' '+l.amount)).join('\n')); }

    function resetIncomeForm(){ document.getElementById('incomeForm').reset(); }

    // ---------- Transfers ----------
    function saveTransfer(e){ if(e) e.preventDefault(); const date = document.getElementById('trDate').value; const amount = parseFloat(document.getElementById('trAmount').value||0); const from = document.getElementById('trFrom').value; const to = document.getElementById('trTo').value; const desc = document.getElementById('trDesc').value; if(!date||!amount||!from||!to){ alert('Please fill date, amount, from and to accounts'); return false }
      // create GL entry: debit 'to' account, credit 'from' account
      const entry = { id:'j'+Math.random().toString(36).slice(2,9), date, ref: 'TR-'+Math.floor(Math.random()*9000+1000), description: 'Transfer '+(desc||''), lines: [ {account: to, dc:'debit', amount}, {account: from, dc:'credit', amount} ], totalDebit: amount, totalCredit: amount };
      journal.push(entry); localStorage.setItem(GL_KEY, JSON.stringify(journal)); transfers.push({ id:'t'+Math.random().toString(36).slice(2,9), date, from, to, amount, journalId: entry.id, description: desc }); localStorage.setItem(TR_KEY, JSON.stringify(transfers)); renderTransfers(); loadAll(); alert('Transfer posted to GL'); return false; }

    function renderTransfers(){ const tbody = document.querySelector('#transferTable tbody'); tbody.innerHTML=''; transfers.slice().reverse().forEach(t=>{ const accFrom = coa.find(a=> (a.code||a.id) === t.from); const accTo = coa.find(a=> (a.code||a.id) === t.to); const tr = document.createElement('tr'); tr.innerHTML = `<td>${t.date}</td><td>${accFrom? (accFrom.code? accFrom.code+' — ':'')+accFrom.name : t.from}</td><td>${accTo? (accTo.code? accTo.code+' — ':'')+accTo.name : t.to}</td><td class="right">${Number(t.amount).toLocaleString()}</td><td style="text-align:right"><button class="small ghost" onclick="viewJournal('${t.journalId}')">View</button></td>`; tbody.appendChild(tr); }); }

    function resetTransferForm(){ document.getElementById('transferForm').reset(); }

    // ---------- Other (Custom Journal) ----------
    let otherLines = [];
    function addOtherLine(){ const acc = document.getElementById('otAccount').value; const dc = document.getElementById('otDC').value; const amt = parseFloat(document.getElementById('otAmount').value||0); const desc = document.getElementById('otDesc').value||''; if(!acc || amt<=0){ alert('Select account and enter amount'); return } otherLines.push({account:acc,dc,amount:amt,desc}); renderOtherLines(); }

    function renderOtherLines(){ const tbody = document.querySelector('#otherLinesTable tbody'); tbody.innerHTML=''; let d=0,c=0; otherLines.forEach((l,idx)=>{ const acc = coa.find(a=> (a.code||a.id)===l.account); const accLabel = acc? ((acc.code?acc.code+' — ':'')+acc.name) : l.account; const tr = document.createElement('tr'); tr.innerHTML = `<td>${accLabel}</td><td>${escapeHtml(l.desc||'')}</td><td class="right">${l.dc==='debit'?Number(l.amount).toLocaleString():'-'}</td><td class="right">${l.dc==='credit'?Number(l.amount).toLocaleString():'-'}</td><td style="text-align:right"><button class="small ghost" onclick="removeOtherLine(${idx})">Remove</button></td>`; tbody.appendChild(tr); if(l.dc==='debit') d+=l.amount; else c+=l.amount; }); document.getElementById('otherDebitTotal').textContent = Number(d).toLocaleString(); document.getElementById('otherCreditTotal').textContent = Number(c).toLocaleString(); }

    function removeOtherLine(i){ otherLines.splice(i,1); renderOtherLines(); }

    function saveOther(e){ if(e) e.preventDefault(); const date = document.getElementById('otDate').value; const ref = document.getElementById('otRef').value; if(!date){ alert('Select date'); return false } if(otherLines.length<1){ alert('Add at least one line'); return false } const totals = otherLines.reduce((acc,l)=>{ if(l.dc==='debit') acc.debit+=l.amount; else acc.credit+=l.amount; return acc },{debit:0,credit:0}); if(Math.abs(totals.debit - totals.credit) > 0.0001){ alert('Journal not balanced. Debits must equal Credits'); return false }
      const entry = { id:'j'+Math.random().toString(36).slice(2,9), date, ref, description: 'Custom Journal '+(ref||''), lines: otherLines.map(l=> ({account:l.account,dc:l.dc,amount:l.amount,desc:l.desc})), totalDebit: totals.debit, totalCredit: totals.credit };
      journal.push(entry); localStorage.setItem(GL_KEY, JSON.stringify(journal)); otherJournals.push({ id:'o'+Math.random().toString(36).slice(2,9), date, ref, journalId: entry.id }); localStorage.setItem(OT_KEY, JSON.stringify(otherJournals)); otherLines = []; renderOtherLines(); loadAll(); alert('Journal posted to GL'); return false; }

    function renderOtherList(){ // not used currently
    }

    function resetOtherForm(){ document.getElementById('otherForm').reset(); otherLines = []; renderOtherLines(); }

    // utilities
    function escapeHtml(s){ return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;') }

    function exportAll(){ const rows = [];
      expenses.forEach(e=> rows.push(['Expense',e.date,e.dept,e.category,e.amount,e.status,e.description].join(',')));
      incomes.forEach(i=> rows.push(['Income',i.date,i.source,'',i.amount,'',i.description].join(',')));
      transfers.forEach(t=> rows.push(['Transfer',t.date,t.from+'->'+t.to,'',t.amount,'',t.description].join(',')));
      const csv = rows.join('\n'); const blob = new Blob([csv],{type:'text/csv'}); const url = URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='transactions_export.csv'; a.click(); URL.revokeObjectURL(url);
    }

    // init
    document.addEventListener('DOMContentLoaded', ()=>{ loadCOA(); loadAll(); showTab('expense'); });
  </script>
</body>
</html>
